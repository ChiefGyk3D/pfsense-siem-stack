# suppress.conf - Suricata Conditional Suppression List
#
# PURPOSE: Suppress alerts based on CONDITIONS (IP, direction, tracking)
# PERFORMANCE: Rules STILL RUN but alerts hidden for specific conditions
#
# DIFFERENCE from disablesid.conf:
#   - suppress.conf: Rules run but alerts conditionally hidden (IP-specific)
#   - disablesid.conf: Rules NOT LOADED at all (better performance, global)
#
# BEST PRACTICE:
#   - Use suppress.conf ONLY for IP-specific or conditional suppressions
#   - Use disablesid.conf for global disables (better performance)
#
# SYNTAX:
#   suppress gen_id 1, sig_id XXXXX                           # Global (BAD - use disablesid.conf)
#   suppress gen_id 1, sig_id XXXXX, track by_src, ip X.X.X.X # Conditional (GOOD)
#   suppress gen_id 1, sig_id XXXXX, track by_dst, ip X.X.X.X # Conditional (GOOD)
#   suppress gen_id 1, sig_id XXXXX, track by_src, ip X.X.X.X/24 # CIDR supported
#
# Last Updated: 2025-11-27
# Total Conditional Suppressions: 2 (IP-specific only)
# ============================================================================

# ============================================================================
# CONDITIONAL SUPPRESSIONS (IP-Specific False Positives)
# ============================================================================

# SID 2221034 - SURICATA HTTP Request unrecognized authorization method
# Microsoft IP generates this alert with proprietary auth methods
# Only suppress traffic TO this specific Microsoft Azure IP
suppress gen_id 1, sig_id 2221034, track by_dst, ip 52.96.79.200

# SID 2038669 - ET EXPLOIT Realtek eCos RSDK/MSDK Stack-based Buffer Overflow (CVE-2022-27255)
# AWS EC2 IP generates false positive for this exploit detection
# Only suppress traffic FROM this specific AWS IP
suppress gen_id 1, sig_id 2038669, track by_src, ip 13.59.225.146

# ============================================================================
# END OF CONDITIONAL SUPPRESSIONS
# ============================================================================
# All global suppressions (65 SIDs) have been moved to disablesid.conf
# for better performance (rules not loaded vs alerts just hidden)
#
# Moved on: 2025-11-27
# Includes:
#   - 52 standard Suricata rules (gen_id 1)
#   - 13 preprocessor rules (gen_id 3, 119, 120, 137, 138, 140, 141)
#
# Performance Improvement:
#   Before: 67 rules loaded, 65 globally suppressed (wasted CPU/memory)
#   After:  2 rules loaded, 2 conditionally suppressed (optimal)
#
# To add NEW conditional suppressions:
#   1. Identify the SID generating false positives for specific IPs
#   2. Add suppress line with track by_src or by_dst and IP address
#   3. Example: suppress gen_id 1, sig_id XXXXX, track by_src, ip 1.2.3.4
#
# For global disables (not IP-specific):
#   Add to: config/sid/disable/disablesid.conf
# ============================================================================
